includes:
    - vendor/larastan/larastan/extension.neon
    - vendor/nesbot/carbon/extension.neon

parameters:
    paths:
        - app/

    # Rule level (0-9, 9 is the strictest)
    level: 5

    # Don't treat PHPDoc types as certain (allows runtime type narrowing)
    treatPhpDocTypesAsCertain: false

    # Don't report unmatched ignored errors
    reportUnmatchedIgnoredErrors: false

    excludePaths:
        - app/Console/Commands/_archive/*

    ignoreErrors:
        # Unused methods may be called dynamically or kept for future use
        - '#Method .+::.+ is unused\.#'
        # Unused traits may be used conditionally
        - '#Trait .+ is used zero times#'
        # Unresolvable callback types (common with Eloquent Collection methods)
        - '#contains unresolvable type\.#'
        # Properties on generic Model (dynamic Eloquent queries return base Model type)
        - '#Access to an undefined property Illuminate\\Database\\Eloquent\\Model::\$#'
        # Nullsafe access for defensive coding
        - '#Using nullsafe .+ on non-nullable type#'
        - '#Using nullsafe .+ on left side of \?\? is unnecessary#'
        # Empty/isset false positives with type narrowing
        - '#in empty\(\) always exists and is always falsy#'
        - '#in isset\(\) always exists and is not nullable#'
        # Property only written (injected services kept for future use)
        - '#Property .+ is never read, only written\.#'
        # is_array checks with type narrowing
        - '#Call to function is_array\(\) with array will always evaluate to true#'
        - '#Result of && is always false#'
        # instanceof narrowing issues
        - '#Instanceof between .+ will always evaluate to (true|false)#'
        # Eloquent Model method calls on generic model types (ProductSearchService)
        - '#Call to an undefined method Illuminate\\Database\\Eloquent\\Collection.+::searchable#'
        # Variable might not be defined (false positive with early returns)
        - '#Variable \$errors might not be defined#'
        # Boolean narrowing issues (when PHPDoc says different from runtime)
        - '#Negated boolean expression is always true#'
        - '#If condition is always true#'
        # Return type issues where we're intentionally flexible
        - '#never returns .+ so it can be removed from the return type#'
        # Model getProfitAnalysis() called on generic Model (dynamic Eloquent)
        - '#Call to an undefined method Illuminate\\Database\\Eloquent\\Model::getProfitAnalysis#'
        # Parameter type for ProductBadgeService with generic Model
        - '#expects App\\Models\\Product, Illuminate\\Database\\Eloquent\\Model given#'
        # Unused class constants (kept for documentation or future use)
        - '#Constant .+ is unused\.#'
        # Variable always exists false positives
        - '#on left side of \?\? always exists and is not nullable#'
        # Collection custom methods (custom collection classes or macros)
        - '#Call to an undefined method Illuminate\\Support\\Collection.+::(toApiFormat|validationErrors)#'
        # Anonymous function return type with sum operations returning float
        - '#Anonymous function should return 0 but returns float#'
        # Closure argument type mismatches in map operations
        - '#Closure\(App\\Models\\SyncLog\)#'
        # Aggregate properties from SQL SELECT AS (not real model properties)
        - '#Access to an undefined property App\\Models\\OrderItem::\$(sale_date|revenue|category|total_quantity|total_revenue|total_sold|avg_selling_price)#'
        # LinnworksOrder readonly class property alias
        - '#Access to an undefined property App\\DataTransferObjects\\LinnworksOrder::\$orderNumber#'
